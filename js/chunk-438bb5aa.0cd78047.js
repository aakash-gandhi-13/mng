(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-438bb5aa"],{"1a0f":function(e,t,s){},"2b76":function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("b-form",{on:{submit:function(t){return t.preventDefault(),e.submit(t)}}},[s("b-row",{staticClass:"d-flex align-items-center"},[s("b-col",{attrs:{cols:"12",xl:"2"}},[s("label",{staticClass:"highLightHeaderLabel"},[e._v(e._s(e.$t("CORRESPONDINGTYPE")))]),e._v(" "),s("b-button",{staticClass:"px-2 required-btnAny align-content-center",attrs:{variant:"primary"}},[e._v(e._s(e.$t("REQUIREDBUTTON")))])],1),s("b-col",{attrs:{cols:"12",xl:"2"}},[s("b-form-select",{attrs:{plain:!0,options:e.correspondingTypeOptions},model:{value:e.messageForm.type,callback:function(t){e.$set(e.messageForm,"type",t)},expression:"messageForm.type"}}),s("show-errors",{attrs:{control:e.$v.messageForm.type,field:e.$t("CORRESPONDINGTYPE")}})],1),s("b-col",{attrs:{cols:"12",xl:"2"}},[s("label",{staticClass:"highLightHeaderLabel"},[e._v(e._s(e.$t("CUSTOMERRESPONSEDATE")))]),e._v(" "),s("b-button",{staticClass:"px-2 required-btnAny align-content-center",attrs:{variant:"primary"}},[e._v(e._s(e.$t("REQUIREDBUTTON")))])],1),s("b-col",{attrs:{cols:"12",xl:"2"}},[s("DatePicker",{attrs:{"input-class":"form-control",format:"YYYY/MM/DD hh:mm",type:"datetime"},model:{value:e.$v.messageForm.customer_response_date.$model,callback:function(t){e.$set(e.$v.messageForm.customer_response_date,"$model","string"===typeof t?t.trim():t)},expression:"$v.messageForm.customer_response_date.$model"}}),s("show-errors",{attrs:{control:e.$v.messageForm.customer_response_date,field:e.$t("CUSTOMERRESPONSEDATE")}})],1),s("b-col",{attrs:{cols:"12",xl:"2"}},[s("label",{staticClass:"highLightHeaderLabel"},[e._v(e._s(e.$t("ACTION")))]),e._v(" "),s("b-button",{staticClass:"px-2 required-btnAny align-content-center",attrs:{variant:"primary"}},[e._v(e._s(e.$t("REQUIREDBUTTON")))])],1),s("b-col",{attrs:{cols:"12",xl:"2"}},[s("b-form-select",{staticClass:"wdtAlign",attrs:{plain:!0,options:e.actionOptions},model:{value:e.messageForm.action,callback:function(t){e.$set(e.messageForm,"action",t)},expression:"messageForm.action"}}),s("show-errors",{attrs:{control:e.$v.messageForm.action,field:e.$t("ACTION")}})],1)],1),s("br"),s("b-row",{staticClass:"d-flex align-items-center"},[s("b-col",{attrs:{cols:"12",xl:"2"}},[s("label",{staticClass:"highLightHeaderLabel"},[e._v(e._s(e.$t("MESSAGETITLE")))]),e._v(" "),s("b-button",{staticClass:"px-2 required-btnAny align-content-center",attrs:{variant:"primary"}},[e._v(e._s(e.$t("REQUIREDBUTTON")))])],1),s("b-col",{attrs:{cols:"12",xl:"10"}},[s("b-form-input",{staticClass:"form-control",model:{value:e.$v.messageForm.title.$model,callback:function(t){e.$set(e.$v.messageForm.title,"$model","string"===typeof t?t.trim():t)},expression:"$v.messageForm.title.$model"}}),s("show-errors",{attrs:{control:e.$v.messageForm.title,field:e.$t("MESSAGETITLE")}})],1)],1),s("br"),s("b-row",{staticClass:"d-flex"},[s("b-col",{attrs:{cols:"12",xl:"2"}},[s("label",{staticClass:"highLightHeaderLabel"},[e._v(e._s(e.$t("MAILCONTENT")))]),e._v(" "),s("b-button",{staticClass:"px-2 required-btnAny align-content-center",attrs:{variant:"primary"}},[e._v(e._s(e.$t("REQUIREDBUTTON")))])],1),s("b-col",{attrs:{cols:"12",xl:"10"}},[s("b-form-textarea",{staticClass:"mb-1",attrs:{id:"textarea-rows",rows:"8"},model:{value:e.$v.messageForm.content.$model,callback:function(t){e.$set(e.$v.messageForm.content,"$model","string"===typeof t?t.trim():t)},expression:"$v.messageForm.content.$model"}}),s("show-errors",{attrs:{control:e.$v.messageForm.content,field:e.$t("MAILCONTENT")}})],1)],1),s("br"),s("p",{staticClass:"text-danger"},[e._v(e._s(e.fileErrorMessage))]),s("b-row",{staticClass:"d-flex align-items-center"},[s("b-col",{attrs:{cols:"12",xl:"2"}}),s("b-col",{attrs:{cols:"12",xl:"10"}},[s("div",{staticClass:"border border-dark pl-4 pr-4"},[s("b-row",{staticClass:"pt-2 pb-2"},[s("b-col",{attrs:{xl:"3"}},[s("b-button",{staticClass:"mb-2",attrs:{id:"fileSelectBtn",variant:"primary"}},[s("label",{attrs:{for:"avatar"}},[e._v(e._s(e.$t("FILESELECTION")))])]),s("input",{attrs:{id:"avatar",type:"file",name:"avatar",multiple:"multiple",hidden:""},on:{change:e.onFileChange}})],1),s("b-col",{staticClass:"border border-dark pl-4 pr-4 ml-2",attrs:{xl:"8"}},[s("b-card-text",[e.files.length?s("div",e._l(e.files,(function(t,n){return s("div",{key:n},[e._v(" "+e._s(t.name)+" "),s("b-link",{staticClass:"card-link link",attrs:{href:"javascript:;"},on:{click:function(t){return e.deleteFile(n)}}},[s("u",[e._v(e._s(e.$t("DELETE")))])])],1)})),0):s("div")])],1)],1)],1)])],1),s("b-button",{staticClass:"mt-2",attrs:{disabled:e.disabled,variant:"primary",type:"submit"}},[e._v(e._s(e.$t("CUSTOMERSUPPORTREGISTRATION"))+" "),e.loading?s("i",{staticClass:"fa fa-spinner fa-spin"}):e._e()]),s("br"),s("br")],1)],1)},a=[],r=(s("8e6e"),s("ac6a"),s("cadf"),s("456d"),s("7f7f"),s("28a5"),s("96cf"),s("3b8d")),i=s("bd86"),o=s("3f54"),l=s("d3a4"),c=s("c827"),p=s("b5ae"),u=s("2f62"),d=s("2f4e");function m(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function _(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?m(s,!0).forEach((function(t){Object(i["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):m(s).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var h=o["a"].get("basic"),f={type:"001",customer_response_date:"",action:"001",title:"",content:""},g={name:"ClientTransactionAdd",components:{ShowErrors:c["a"]},data:function(){return{messageForm:{type:"001",customer_response_date:"",action:"001",title:"",content:""},files:[],fileErrorMessage:"",loading:!1,disabled:!1,message_type:"005",message_sender_account_type:"",selectedClientIcon:"",clientBaseInfo:{},senderBelongs:"",senderIconPath:""}},validations:{messageForm:{type:{required:p["required"]},customer_response_date:{required:p["required"]},action:{required:p["required"]},title:{required:p["required"]},content:{required:p["required"]}}},computed:_({},Object(u["b"])({client_details:"getUserDetails",selected_client_data:"getClientData",PayLoad:"getQuotationNo",assessment_Details:"getAssesmentNo"}),{correspondingTypeOptions:function(){return[{text:l["a"].t("TELEPHONE"),value:"001"},{text:l["a"].t("FAX"),value:"002"},{text:l["a"].t("EMAIL1"),value:"003"},{text:l["a"].t("FACETOFACE"),value:"004"},{text:l["a"].t("MEMOPERSONINCHANGE"),value:"005"},{text:l["a"].t("MESSAGETRANSMISSION"),value:"006"}]},actionOptions:function(){return[{text:l["a"].t("CONTACTFROMCUSTOMER"),value:"001"},{text:l["a"].t("CONTACTFROMPERSONINCHARGE"),value:"002"},{text:l["a"].t("SENDMESSAGETOCUSTOMER"),value:"003"},{text:l["a"].t("OTHER"),value:"004"}]}}),mounted:function(){this.getClientIconPath(),this.getSelectedClientData()},created:function(){this.selected_client_data.client_no||this.$router.push({name:"client_list"})},methods:{getClientIconPath:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,h.postAPI(d["a"].MASTERREADDATAMCLIENTOTHERINFO,{fieldlist:["client_no","icon_path"],conditions:[{key:"client_no",value:this.selected_client_data.client_no}]});case 2:t=e.sent,s=t.data,s.success&&(n=s.data,n.length>0&&(this.selectedClientIcon=n[0].icon_path?n[0].icon_path:""));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getSelectedClientData:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,h.postAPI(d["a"].MASTERREADDATAMCLIENTBASEINFO,{fieldlist:["*"],conditions:[{key:"client_no",value:this.selected_client_data.client_no}]});case 2:t=e.sent,s=t.data,s.success&&(n=s.data,n.length>0&&(this.clientBaseInfo=n[0]?n[0]:""));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onFileChange:function(e){this.fileErrorMessage="";var t=this.files.length;if(e.target.files.length+t>5)return this.fileErrorMessage=this.$t("MAXFILENO"),!0;for(var s=0,n=0;n<e.target.files.length;n++){var a=e.target.files[n].name.split(".").pop();if("sh"==a||"exe"==a)return this.fileErrorMessage=this.$t("CANTNOTUPLOADEXCECUTABLEFILE"),!0;s+=Math.round(e.target.files[n].size/1024)}if(s>10240)return this.fileErrorMessage=this.$t("MAXFILESIZE"),!0;for(var r=0;r<e.target.files.length;r++)this.files.push(e.target.files[r])},deleteFile:function(e){this.files.splice(e,1)},submit:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$v.messageForm.$touch(),this.$v.messageForm.$invalid||this.reply();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getIconSenderPath:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var s,n,a,r,i,o,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s="",!t){e.next=10;break}return e.next=4,h.postAPI(d["a"].MASTERREADDATAMSUPPLIER,{fieldlist:["*"],conditions:[{key:"supplier_no",value:this.PayLoad.supplierNo}]});case 4:return n=e.sent,a=n.data,a.success&&(r=a.data,r.length>0&&(s=r[0].icon_path?r[0].icon_path:"")),e.abrupt("return",s);case 10:return e.next=12,h.postAPI(d["a"].MASTERREADALLMPERSON,{fieldlist:["*"],conditions:[{key:"person_id",value:localStorage.getItem("personID")}]});case 12:return i=e.sent,o=i.data,o.success&&(l=o.data,l.length>0&&(s=l[0].icon_path?l[0].icon_path:"")),e.abrupt("return",s);case 16:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),getSenderIconPath:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,n,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!=this.PayLoad.Proposal_no||""!=this.assessment_Details.assesmentno){e.next=18;break}if("001"!=this.messageForm.action){e.next=5;break}this.senderIconPath=this.selectedClientIcon&&"undefined"!=this.selectedClientIcon&&"null"!=this.selectedClientIcon?this.selectedClientIcon:"",e.next=18;break;case 5:if(t=localStorage.getItem("supplier_auth"),s=localStorage.getItem("personID"),"true"!=t){e.next=15;break}return e.next=10,h.postAPI(d["a"].MASTERREADWITHJOINMSUPPLIERPERSONINFO,{limit:50,offset:0,paginate:!1,fieldlist:["m_supplier_person_info.supplier_person_info_no","m_supplier_person_info.supplier_no","m_supplier_person_info.person_id","m_supplier.supplier_name","m_supplier.icon_path"],conditions:[{key:"m_supplier_person_info.person_id",value:s},{key:"m_supplier_person_info.del_flg",value:"false"},{key:"m_supplier.del_flg",value:"false"}],joins:[{table:"m_supplier",join_type:"left",join_conditions:[{join_using:"m_supplier.supplier_no",join_operator:"=",join_with:"m_supplier_person_info.supplier_no"}]}]});case 10:n=e.sent,a=n.data,a.success?(r=a.data.data,r.length>0?this.senderIconPath=r[0].icon_path:this.senderIconPath=""):this.senderIconPath="",e.next=18;break;case 15:return e.next=17,this.getIconSenderPath(!1);case 17:this.senderIconPath=e.sent;case 18:if(!this.PayLoad.Proposal_no){e.next=26;break}if("001"!=this.messageForm.action){e.next=23;break}this.senderIconPath=this.selectedClientIcon&&"undefined"!=this.selectedClientIcon&&"null"!=this.selectedClientIcon?this.selectedClientIcon:"",e.next=26;break;case 23:return e.next=25,this.getIconSenderPath(!0);case 25:this.senderIconPath=e.sent;case 26:if(!this.assessment_Details.assesmentno){e.next=34;break}if("001"!=this.messageForm.action){e.next=31;break}this.senderIconPath=this.selectedClientIcon&&"undefined"!=this.selectedClientIcon&&"null"!=this.selectedClientIcon?this.selectedClientIcon:"",e.next=34;break;case 31:return e.next=33,this.getIconSenderPath(!1);case 33:this.senderIconPath=e.sent;case 34:return console.log("HHHHHHHHHHH",this.senderIconPath),e.abrupt("return",this.senderIconPath);case 36:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getSenderBelongs:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,n,a,r,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!=this.PayLoad.Proposal_no||""!=this.assessment_Details.assesmentno){e.next=18;break}if("001"!=this.messageForm.action){e.next=5;break}this.senderBelongs=this.clientBaseInfo.client_name,e.next=18;break;case 5:if(t=localStorage.getItem("admin_auth"),s=localStorage.getItem("supplier_auth"),n=localStorage.getItem("wiz_auth"),a=localStorage.getItem("personID"),"true"!=s){e.next=17;break}return e.next=12,h.postAPI(d["a"].MASTERREADWITHJOINMSUPPLIERPERSONINFO,{limit:50,offset:0,paginate:!1,fieldlist:["m_supplier_person_info.supplier_person_info_no","m_supplier_person_info.supplier_no","m_supplier_person_info.person_id","m_supplier.supplier_name","m_supplier.icon_path"],conditions:[{key:"m_supplier_person_info.person_id",value:a},{key:"m_supplier_person_info.del_flg",value:"false"},{key:"m_supplier.del_flg",value:"false"}],joins:[{table:"m_supplier",join_type:"left",join_conditions:[{join_using:"m_supplier.supplier_no",join_operator:"=",join_with:"m_supplier_person_info.supplier_no"}]}]});case 12:r=e.sent,i=r.data,i.success?(o=i.data.data,o.length>0?this.senderBelongs=o[0].supplier_name:this.senderBelongs=""):this.senderBelongs="",e.next=18;break;case 17:"true"==n?this.senderBelongs="WIZ":"true"==t&&(this.senderBelongs="システム管理");case 18:return this.PayLoad.Proposal_no&&("001"==this.messageForm.action?this.senderBelongs=this.clientBaseInfo.client_name:this.senderBelongs=this.PayLoad.Supplier),this.assessment_Details.assesmentno&&("001"==this.messageForm.action?this.senderBelongs=this.clientBaseInfo.client_name:this.senderBelongs="WIZ"),e.abrupt("return",this.senderBelongs);case 21:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),reply:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,n,a,r,i,o,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for("006"==this.messageForm.type&&(this.message_type="004"),t=localStorage.getItem("admin_auth"),s=localStorage.getItem("supplier_auth"),n=localStorage.getItem("wiz_auth"),a=localStorage.getItem("personID"),"001"==this.messageForm.action?this.message_sender_account_type="001":"true"==s?this.message_sender_account_type="002":"true"==n?this.message_sender_account_type="003":"true"==t&&(this.message_sender_account_type="004"),r=new FormData,i=0;i<this.files.length;i++)r.append("attachments[]",this.files[i]);return r.append("client_support_type",this.messageForm.type),r.append("client_no",this.selected_client_data.client_no),r.append("message_dt",this.messageForm.customer_response_date.getTime()),r.append("client_support_action_type",this.messageForm.action),r.append("message_type",this.message_type),r.append("message_sender_account_type",this.message_sender_account_type),r.append("message_sender_account_no","001"==this.messageForm.action?this.client_no:this.client_details.client_account_no),r.append("message_sender_person_name","001"==this.messageForm.action?this.clientBaseInfo.client_person_name:this.client_details.clientPersonName),r.append("message_sender_belongs",this.getSenderBelongs()),r.append("reduction_proposal_no",this.PayLoad.Proposal_no?this.PayLoad.Proposal_no:0),r.append("assess_req_no",this.assessment_Details.assesmentno?this.assessment_Details.assesmentno:0),e.t0=r,e.next=22,this.getSenderIconPath();case 22:return e.t1=e.sent,e.t0.append.call(e.t0,"message_sender_icon_path",e.t1),r.append("message_title",this.messageForm.title),r.append("message_text",this.messageForm.content),r.append("attached_file_flg",this.files.length>0),r.append("person_id",a),r.append("create_id",a),r.append("update_id",a),this.loading=!0,this.disabled=!0,e.next=34,h.postAPI(d["a"].MESSAGECREATECOMMUNICATION,r);case 34:o=e.sent,l=o.data,this.loading=!1,this.disabled=!1,l.success?(this.messageForm=_({},f),this.files=[],this.$v.$reset(),this.$router.push({name:"client_process"})):console.log("REPLY POSTED FAILED");case 39:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},b=g,v=(s("f56d"),s("2877")),I=Object(v["a"])(b,n,a,!1,null,"d1e77830",null);t["default"]=I.exports},"454f":function(e,t,s){s("46a7");var n=s("584a").Object;e.exports=function(e,t,s){return n.defineProperty(e,t,s)}},"46a7":function(e,t,s){var n=s("63b6");n(n.S+n.F*!s("8e60"),"Object",{defineProperty:s("d9f6").f})},"85f2":function(e,t,s){e.exports=s("454f")},"8e6e":function(e,t,s){var n=s("5ca1"),a=s("990b"),r=s("6821"),i=s("11e9"),o=s("f1ae");n(n.S,"Object",{getOwnPropertyDescriptors:function(e){var t,s,n=r(e),l=i.f,c=a(n),p={},u=0;while(c.length>u)s=l(n,t=c[u++]),void 0!==s&&o(p,t,s);return p}})},"990b":function(e,t,s){var n=s("9093"),a=s("2621"),r=s("cb7c"),i=s("7726").Reflect;e.exports=i&&i.ownKeys||function(e){var t=n.f(r(e)),s=a.f;return s?t.concat(s(e)):t}},bd86:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("85f2"),a=s.n(n);function r(e,t,s){return t in e?a()(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}},f56d:function(e,t,s){"use strict";var n=s("1a0f"),a=s.n(n);a.a}}]);
//# sourceMappingURL=chunk-438bb5aa.0cd78047.js.map